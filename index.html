<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">

<!-- âœ… ëª¨ë°”ì¼ ëŒ€ì‘ í•µì‹¬ -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>ë„ì˜¤í˜í˜ì¼€ ê·¸ë¦¬ê³  ì²œìœ ì„± ë“œê°€ë¥¼ ë“œê°€</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f2f2f2;
    text-align: center;
    margin-top: 30px;
  }

  input {
    padding: 10px;
    margin: 5px;
    font-size: 16px;
    width: 80%;
    max-width: 300px;
  }

  button {
    padding: 10px 18px;
    font-size: 16px;
    cursor: pointer;
    margin: 5px;
    touch-action: manipulation;
  }

  #gameBox {
    width: 90vw;
    max-width: 420px;
    height: 220px;
    background: #ccc;
    margin: 20px auto;
    display: none;
    align-items: center;
    justify-content: center;
    font-size: 22px;
    border-radius: 12px;
    cursor: pointer;
    user-select: none;
    touch-action: manipulation;
  }

  #ranking {
    width: 90vw;
    max-width: 420px;
    margin: 30px auto;
    background: #fff;
    border-radius: 12px;
    padding: 15px;
    text-align: left;
  }

  #myResetBtn {
    margin-top: 10px;
    background: #e67e22;
    color: white;
    border: none;
    border-radius: 6px;
    width: 100%;
  }

  ol {
    padding-left: 20px;
    font-size: 14px;
  }
</style>
</head>
<body>

<h1>âš¡ ë„ì˜¤í˜í˜ì¼€ ê·¸ë¦¬ê³  ì²œìœ ì„± ë“œê°€ë¥¼ ë“œê°€</h1>

<!-- ë¡œê·¸ì¸ -->
<div id="loginBox">
  <h3>ğŸ” ë¡œê·¸ì¸</h3>
  <input id="username" placeholder="ì´ë¦„">
  <input id="password" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸">
  <br>
  <button onclick="login()">ë¡œê·¸ì¸ / íšŒì›ê°€ì…</button>
  <div id="loginMsg"></div>
</div>

<!-- ê²Œì„ -->
<div id="gameSection">
  <p id="welcome"></p>
  <div id="gameBox">ì‹œì‘ ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”</div>
  <button onclick="startGame()">ì‹œì‘</button>
  <div id="result"></div>
</div>

<!-- ë­í‚¹ -->
<div id="ranking">
  <h3>ğŸ† ë­í‚¹ TOP 10</h3>
  <ol id="rankingList"></ol>
  <button id="myResetBtn" onclick="resetMyRecords()">ğŸ—‘ ë‚´ ê¸°ë¡ë§Œ ì´ˆê¸°í™”</button>
</div>

<script>
  const loginBox = document.getElementById("loginBox");
  const gameBox = document.getElementById("gameBox");
  const rankingList = document.getElementById("rankingList");
  const welcome = document.getElementById("welcome");
  const result = document.getElementById("result");
  const loginMsg = document.getElementById("loginMsg");

  let currentUser = null;
  let startTime = 0;
  let waiting = false;
  let ready = false;
  let timeoutId;

  let users = JSON.parse(localStorage.getItem("users")) || {};
  let rankings = JSON.parse(localStorage.getItem("reactionRankings")) || [];

  function login() {
    const name = username.value.trim();
    const pw = password.value;

    if (!name || !pw) {
      loginMsg.textContent = "ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.";
      return;
    }

    if (!users[name]) {
      users[name] = { password: pw };
      localStorage.setItem("users", JSON.stringify(users));
    } else if (users[name].password !== pw) {
      loginMsg.textContent = "âŒ ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.";
      return;
    }

    currentUser = name;
    loginBox.style.display = "none";
    gameBox.style.display = "flex";
    welcome.textContent = `ğŸ‘‹ ${name} ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤`;
  }

  function startGame() {
    result.textContent = "";
    ready = false;
    waiting = true;
    gameBox.style.background = "#e74c3c";
    gameBox.textContent = "ê¸°ë‹¤ë¦¬ì„¸ìš”...";

    const delay = Math.random() * 3000 + 2000;

    timeoutId = setTimeout(() => {
      gameBox.style.background = "#2ecc71";
      gameBox.textContent = "ì§€ê¸ˆ í„°ì¹˜!";
      startTime = Date.now();
      ready = true;
      waiting = false;
    }, delay);
  }

  gameBox.addEventListener("click", () => {
    if (waiting) {
      clearTimeout(timeoutId);
      gameBox.style.background = "#ccc";
      gameBox.textContent = "ë„ˆë¬´ ë¹¨ëì–´ìš”!";
      result.textContent = "âŒ ì‹¤íŒ¨";
      waiting = false;
    } else if (ready) {
      const time = Date.now() - startTime;
      saveRanking(time);
      gameBox.style.background = "#ccc";
      gameBox.textContent = "ì™„ë£Œ!";
      result.textContent = `ğŸ‰ ${time} ms`;
      ready = false;
    }
  });

  function saveRanking(time) {
    rankings.push({
      user: currentUser,
      time,
      date: new Date().toLocaleString()
    });

    rankings.sort((a, b) => a.time - b.time);
    rankings = rankings.slice(0, 10);

    localStorage.setItem("reactionRankings", JSON.stringify(rankings));
    renderRanking();
  }

  function resetMyRecords() {
    if (!confirm("ë‚´ ê¸°ë¡ë§Œ ì´ˆê¸°í™”í• ê¹Œìš”?")) return;
    rankings = rankings.filter(r => r.user !== currentUser);
    localStorage.setItem("reactionRankings", JSON.stringify(rankings));
    renderRanking();
    result.textContent = "ğŸ—‘ ë‚´ ê¸°ë¡ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.";
  }

  function renderRanking() {
    rankingList.innerHTML = "";
    rankings.forEach(r => {
      const li = document.createElement("li");
      li.textContent = `${r.user} Â· ${r.time} ms Â· ${r.date}`;
      rankingList.appendChild(li);
    });
  }

  renderRanking();
</script>

</body>
</html>
